# ๐ ุชุฏูู ุงูุชุญูู ุนุจุฑ ููุงุฐ (Nafath Authentication Flow)

## ๐ฑ ุงูุชุฏูู ุงููุงูู ููุชุทุจูู

```
1. SplashScreen (2 seconds)
   โ
2. OnboardingScreen (Nafath Verification)
   โ
   [ูุฏุฎู ุงููุณุชุฎุฏู ุฑูู ุงููููุฉ]
   โ
3. ูุชู ุงูุชุญูู ูู ุฑูู ุงููููุฉ (ุชุญุงูู ููุงุฐ)
   โ
4. ุญุณุจ ุฑูู ุงููููุฉ โ ููุชูู ูุณููุงุฑูู ูุนูู
```

---

## ๐ญ ุงูุฃุฑูุงู ุงูุชุฌุฑูุจูุฉ ุงูุฃุฑุจุนุฉ

### 1๏ธโฃ ุณููุงุฑูู ุงูุจูุงุจุฉ ุงูุขููุฉ (SafeGate)
**ุฑูู ุงููููุฉ**: `1234567890`  
**ุงูุงุณู**: ููุฏ ุงูุนุชูุจู  
**ุงููุตู**: ูุณุงูุฑ ุฎุงุฑุฌ ุงูุณุนูุฏูุฉ - ูุญุชุงุฌ SafeGate  
**ุงููููุน**: ุฎุงุฑุฌ ุงูุณุนูุฏูุฉ โ๏ธ  
**ุงููุฌูุฉ**: `/safe-gate`

**ูุง ูุญุฏุซ**:
- ููุชูู ูุจุงุดุฑุฉ ุฅูู ุดุงุดุฉ SafeGate
- ูุฑู ุฎุฏูุงุช:
  - ุฅุฏุงุฑุฉ OTP (ุฑููุฒ ุงูุชุญูู)
  - ุฎุฏูุฉ VPN
  - ุงูููุงููุงุช ุงูุทุงุฑุฆุฉ
  - ุจุงูุฉ ุจุฑููููู (29 ุฑูุงู/ุดูุฑ)
- ูุง ูุธูุฑ ุฒุฑ ุงูุฑุฌูุน
- ุงูุชููู ุนุจุฑ Bottom Navigation

---

### 2๏ธโฃ ุณููุงุฑูู ุฏุงุฎู ุงูุณุนูุฏูุฉ (In Saudi)
**ุฑูู ุงููููุฉ**: `2345678901`  
**ุงูุงุณู**: ุณุงุฑุฉ ุงููุทูุฑู  
**ุงููุตู**: ุฏุงุฎู ุงูุณุนูุฏูุฉ - ูุตูู ูุงูู  
**ุงููููุน**: ุฏุงุฎู ุงูุณุนูุฏูุฉ ๐  
**ุงููุฌูุฉ**: `/home`

**ูุง ูุญุฏุซ**:
- ููุชูู ุฅูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ (HomeScreen)
- ูุตูู ูุงูู ูุฌููุน ุงูููุฒุงุช:
  - ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ ูุน AIWave
  - ุงููุญุงุฏุซุฉ ุงููุตูุฉ ูุน ุณุงุฑุฉ
  - ุฒุฑ ุงูููุงููุฉ ุงูุตูุชูุฉ (Call button)
  - ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช
  - ุงูููู ุงูุดุฎุตู
- Bottom Navigation ูุน 4 ุชุจููุจุงุช
- ูุณุชุทูุน ุงููุตูู ูุฌููุน ุงูุดุงุดุงุช

---

### 3๏ธโฃ ุณููุงุฑูู ูุจุงุฑ ุงูุณู (Elder Mode)
**ุฑูู ุงููููุฉ**: `3456789012`  
**ุงูุงุณู**: ุนุจุฏุงููู ุงููุญุทุงูู  
**ุงููุตู**: ูุจุงุฑ ุงูุณู - ูุงุฌูุฉ ูุจุณุทุฉ  
**ุงููููุน**: ุฏุงุฎู ุงูุณุนูุฏูุฉ ๐  
**ุงููุฌูุฉ**: `/elder-mode`

**ูุง ูุญุฏุซ**:
- ููุชูู ูุจุงุดุฑุฉ ุฅูู Elder Mode Screen
- ูุงุฌูุฉ ูุจุณุทุฉ ุฌุฏุงู:
  - ุณุคุงู ูุงุญุฏ: "ูู ุชุฑุบุจ ุจุงูุชูุงุตู ูุน ูููู ุณุงุฑุฉุ"
  - ุฒุฑ ูุจูุฑ "ูุนู" (ุฃุฎุถุฑ) โ ูุชุตู ุจุงููููู
  - ุฒุฑ ูุจูุฑ "ูุง" (ุฃุญูุฑ) โ ููุชูู ูููุญุงุฏุซุฉ
- ุฃุญุฌุงู ุฎุทูุท ูุจูุฑุฉ (18-22pt)
- ุฃุฒุฑุงุฑ ูุจูุฑุฉ (60x60 minimum)
- ุฃููุงู ุนุงููุฉ ุงูุชุจุงูู

---

### 4๏ธโฃ ุณููุงุฑูู ูุณุงุนุฏุฉ ุงูุฒูุงุฑ (Guest Help)
**ุฑูู ุงููููุฉ**: `4567890123`  
**ุงูุงุณู**: ูุฑูู ุงูุฏูุณุฑู  
**ุงููุตู**: ุฒุงุฆุฑ ุฎุงุฑุฌ ุงูุณุนูุฏูุฉ - ูุณุงุนุฏุฉ ุทูุงุฑุฆ  
**ุงููููุน**: ุฎุงุฑุฌ ุงูุณุนูุฏูุฉ โ๏ธ  
**ุงููุฌูุฉ**: `/guest-help`

**ูุง ูุญุฏุซ**:
- ููุชูู ูุจุงุดุฑุฉ ุฅูู Guest Help Screen
- ูุฑู ูููุฐุฌ ุงูุชุญูู:
  - ุฅุฏุฎุงู ุฑูู ุงููููุฉ (10 ุฃุฑูุงู)
  - ุฅุฏุฎุงู ุงุณู ุงููุฑูุจ
  - ุฒุฑ "ุทูุจ ุงููุณุงุนุฏุฉ"
- ุงูุชุญูู ุงูุชุฏุฑูุฌู:
  1. ูุญุต ุณุฌู ุงูุณูุฑ
  2. ูุทุงุจูุฉ ุงููุฑูุจ (ุฏุฑุฌุฉ ุฃููู/ุซุงููุฉ)
  3. ุฅุฑุณุงู ุทูุจ ุงุชุตุงู ูููุฑูุจ
  4. ูุชุญ ููุงุฉ ุงุชุตุงู ุขููุฉ
- ูุตูู ูุญุฏูุฏ (ููุท ููุทูุงุฑุฆ)

---

## ๐ ุชูุงุตูู ุชุฏูู ุงูุชุญูู

### ุงููุฑุญูุฉ 1: SplashScreen
```dart
Duration: 2 seconds
Elements:
  - SARA Logo animation (scale 0.3 โ 1.0)
  - Fade-in text
  - Progress bar
  - Gradient background
Next: โ /onboarding
```

### ุงููุฑุญูุฉ 2: OnboardingScreen (Nafath Simulation)
```dart
Elements:
  - Nafath logo (verified_user icon)
  - Title: "ุงูุชุญูู ุนุจุฑ ููุงุฐ"
  - Saudi ID input field (10 digits)
  - "ุงูุชุญูู ุนุจุฑ ููุงุฐ" button
  - Test users cards (clickable)
  - Info text

Process:
  1. User enters Saudi ID
  2. Click "ุงูุชุญูู ุนุจุฑ ููุงุฐ" button
  3. Loading state (2 seconds)
  4. Validate ID against test users
  5. If match:
     - Show success dialog with user info
     - Display scenario name
     - "ูุชุงุจุนุฉ" button
  6. If no match:
     - Show error: "ุฑูู ุงููููุฉ ุบูุฑ ุตุญูุญ"
     - Stay on screen
```

### ุงููุฑุญูุฉ 3: Success Dialog
```dart
Title: "โ ุชู ุงูุชุญูู ุจูุฌุงุญ"
Content:
  - "ูุฑุญุจุงู [ุงุณู ุงููุณุชุฎุฏู]"
  - Description
  - "ุงูุณููุงุฑูู: [ุงุณู ุงูุณููุงุฑูู]"
Actions:
  - "ูุชุงุจุนุฉ" button โ Navigate to scenario
```

### ุงููุฑุญูุฉ 4: Navigation to Scenario
```dart
Based on scenario value:
  - scenarioSafeGate   โ context.go('/safe-gate')
  - scenarioInSaudi    โ context.go('/home')
  - scenarioElder      โ context.go('/elder-mode')
  - scenarioGuest      โ context.go('/guest-help')
```

---

## ๐จ ูุงุฌูุฉ ุดุงุดุฉ ููุงุฐ

### ุชุตููู ุงูุดุงุดุฉ
- **Background**: Gradient (primary โ accent)
- **Logo**: White container with verified_user icon
- **Input Field**: White card with shadow
- **Button**: White button with primary text
- **Test Cards**: Semi-transparent white cards

### Test User Cards
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ [Icon] ููุฏ ุงูุนุชูุจู                  โ
โ        1234567890                   โ
โ        ูุณุงูุฑ ุฎุงุฑุฌ ุงูุณุนูุฏูุฉ          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
- Clickable
- Auto-fills ID field
- Shows icon based on scenario:
  - SafeGate: Icons.security
  - In Saudi: Icons.home
  - Elder: Icons.accessibility_new
  - Guest: Icons.help_outline

---

## ๐ ุงูุชุญูู ูุงูุฃูุงู

### ูู ุงูุฅูุชุงุฌ (Production)
```dart
// Instead of local validation:
final result = await NafathAPI.verify(saudiId);

if (result.isSuccess) {
  // Get user data from backend
  final userData = await BackendAPI.getUserData(result.userId);
  
  // Determine scenario based on:
  // - User location (GPS/IP)
  // - User age (from Nafath)
  // - User type (citizen/visitor)
  // - Travel status (from MOI)
  
  final scenario = determineScenario(userData);
  navigateToScenario(scenario);
}
```

### ูู ุงูุชุทุจูู ุงูุญุงูู (Current)
```dart
// Simple lookup in test users array
final matchedUser = testUsers
    .where((user) => user.saudiId == enteredId)
    .firstOrNull;

if (matchedUser != null) {
  navigateToScenario(matchedUser);
}
```

---

## ๐ ูุฎุทุท ุชุฏูู ูุงูู

```
โโโโโโโโโโโโโโโโโโโ
โ   App Launch    โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  SplashScreen   โ (2 sec animation)
โ  - Logo         โ
โ  - Progress     โ
โโโโโโโโโโฌโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      OnboardingScreen               โ
โ      (Nafath Verification)          โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ Enter Saudi ID: [_________]   โ  โ
โ  โ [ุงูุชุญูู ุนุจุฑ ููุงุฐ]            โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                     โ
โ  Test Users:                        โ
โ  โ 1234567890 - ููุฏ (SafeGate)     โ
โ  โ 2345678901 - ุณุงุฑุฉ (In Saudi)    โ
โ  โ 3456789012 - ุนุจุฏุงููู (Elder)    โ
โ  โ 4567890123 - ูุฑูู (Guest)       โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โผ
    [Validation]
         โ
         โโ Match Found โโ
         โ               โ
         โ               โผ
         โ      โโโโโโโโโโโโโโโโโโโ
         โ      โ Success Dialog  โ
         โ      โ โ User Info     โ
         โ      โ [ูุชุงุจุนุฉ]       โ
         โ      โโโโโโโโโโฌโโโโโโโโโ
         โ               โ
         โ               โผ
         โ      [Navigate to Scenario]
         โ               โ
         โ      โโโโโโโโโโดโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโ
         โ      โ                 โ             โ          โ
         โ      โผ                 โผ             โผ          โผ
         โ  /safe-gate        /home      /elder-mode  /guest-help
         โ      โ                 โ             โ          โ
         โ      โผ                 โผ             โผ          โผ
         โ  SafeGate         HomeScreen   ElderMode   GuestHelp
         โ  Screen           + BottomNav   Screen      Screen
         โ                   (4 tabs)
         โ
         โโ No Match โโโโโโบ [Error Message]
                            Stay on Onboarding
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู 1 (SafeGate):
1. ุงูุชุญ ุงูุชุทุจูู
2. ุงูุชุธุฑ ุดุงุดุฉ Splash
3. ูู ุดุงุดุฉ ููุงุฐุ ุฃุฏุฎู: `1234567890`
4. ุงุถุบุท "ุงูุชุญูู ุนุจุฑ ููุงุฐ"
5. ูู Dialog ุงููุฌุงุญุ ุงุถุบุท "ูุชุงุจุนุฉ"
6. **ุงููุชูุฌุฉ**: ุชูุชูู ุฅูู SafeGate Screen
7. **ุงูุชุญูู**:
   - ุชุฑู ุฅุฏุงุฑุฉ OTP
   - ุชุฑู ุฎุฏูุฉ VPN
   - ุชุฑู ุงูููุงููุงุช ุงูุทุงุฑุฆ
   - ูุง ููุฌุฏ ุฒุฑ ุฑุฌูุน
   - Bottom Navigation ูุนูู

### ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู 2 (In Saudi):
1. ูู ุดุงุดุฉ ููุงุฐุ ุฃุฏุฎู: `2345678901`
2. ุงุถุบุท "ุงูุชุญูู ุนุจุฑ ููุงุฐ"
3. ุงุถุบุท "ูุชุงุจุนุฉ"
4. **ุงููุชูุฌุฉ**: ุชูุชูู ุฅูู HomeScreen
5. **ุงูุชุญูู**:
   - ุชุฑู AIWave
   - ุฒุฑ "ุงุจุฏุฃ ูุญุงุฏุซุฉ"
   - Bottom Nav (Home, Chat, Services, Profile)
   - ูููู ุงููุตูู ูุฌููุน ุงูุดุงุดุงุช

### ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู 3 (Elder):
1. ูู ุดุงุดุฉ ููุงุฐุ ุฃุฏุฎู: `3456789012`
2. ุงุถุบุท "ุงูุชุญูู ุนุจุฑ ููุงุฐ"
3. ุงุถุบุท "ูุชุงุจุนุฉ"
4. **ุงููุชูุฌุฉ**: ุชูุชูู ุฅูู ElderModeScreen
5. **ุงูุชุญูู**:
   - ุฒุฑ "ูุนู" ูุจูุฑ (ุฃุฎุถุฑ)
   - ุฒุฑ "ูุง" ูุจูุฑ (ุฃุญูุฑ)
   - ุณุคุงู ูุงุญุฏ ููุท
   - ุฎุทูุท ูุจูุฑุฉ ุฌุฏุงู

### ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู 4 (Guest):
1. ูู ุดุงุดุฉ ููุงุฐุ ุฃุฏุฎู: `4567890123`
2. ุงุถุบุท "ุงูุชุญูู ุนุจุฑ ููุงุฐ"
3. ุงุถุบุท "ูุชุงุจุนุฉ"
4. **ุงููุชูุฌุฉ**: ุชูุชูู ุฅูู GuestHelpScreen
5. **ุงูุชุญูู**:
   - ุญูู ุฑูู ุงููููุฉ
   - ุญูู ุงุณู ุงููุฑูุจ
   - ุฒุฑ "ุทูุจ ุงููุณุงุนุฏุฉ"
   - ุตูุฏูู ุญุงูุฉ ุงูุทูุจ

### ุงุฎุชุจุงุฑ ุฑูู ุฎุงุทุฆ:
1. ูู ุดุงุดุฉ ููุงุฐุ ุฃุฏุฎู: `9999999999`
2. ุงุถุบุท "ุงูุชุญูู ุนุจุฑ ููุงุฐ"
3. **ุงููุชูุฌุฉ**: 
   - ุฑุณุงูุฉ ุฎุทุฃ: "ุฑูู ุงููููุฉ ุบูุฑ ุตุญูุญ. ุฌุฑุจ ุฃุญุฏ ุงูุฃุฑูุงู ุงูุชุฌุฑูุจูุฉ."
   - ุชุจูู ูู ุดุงุดุฉ Onboarding
   - ูููู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู

---

## ๐ก ููุฒุงุช ุฅุถุงููุฉ

### ูุณุฎ ุณุฑูุน (Quick Copy)
- ุงุถุบุท ุนูู ุฃู ุจุทุงูุฉ ูุณุชุฎุฏู ุชุฌุฑูุจู
- ูุชู ูุณุฎ ุฑูู ุงููููุฉ ุชููุงุฆูุงู ุฅูู ุญูู ุงูุฅุฏุฎุงู
- ุฌุงูุฒ ููุถุบุท ุนูู "ุงูุชุญูู"

### ูุนูููุงุช ูุงุถุญุฉ
- ูู ุจุทุงูุฉ ุชุธูุฑ:
  - ุงุณู ุงููุณุชุฎุฏู
  - ุฑูู ุงููููุฉ
  - ูุตู ุงูุณููุงุฑูู
  - ุฃููููุฉ ุงูุณููุงุฑูู
- ูุณูู ุนูู ุงููุฎุชุจุฑูู ููู ูู ุณููุงุฑูู

### ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ
- ุชุญููู (loading) ุฃุซูุงุก ุงูุชุญูู (2 ุซุงููุฉ)
- ุฑุณุงุฆู ูุฌุงุญ/ุฎุทุฃ ูุงุถุญุฉ
- ุงูุชูุงูุงุช ุณูุณุฉ ุจูู ุงูุดุงุดุงุช
- ุชุตููู ูุญุงูู ููุงุฐ ุงูุญูููู

---

## ๐ฏ ุงูููุฎุต

**ุงูุชุฏูู ุงูุตุญูุญ ุงูุขู**:
1. โ Splash โ Onboarding (Nafath)
2. โ 4 ุฃุฑูุงู ุชุฌุฑูุจูุฉ (ูู ุฑูู = ุณููุงุฑูู)
3. โ ุชุญูู ูุญุงูู ููุงุฐ ุงูุญูููู
4. โ ุชูุฌูู ุชููุงุฆู ุญุณุจ ุงูุณููุงุฑูู
5. โ ูู ุณููุงุฑูู ูู ุดุงุดุฉ ุงูุจุฏุงูุฉ ุงูุฎุงุตุฉ ุจู

**ุงูุณููุงุฑูููุงุช**:
- โ SafeGate (ุฎุงุฑุฌ ุงูุณุนูุฏูุฉ)
- โ In Saudi (ุฏุงุฎู ุงูุณุนูุฏูุฉ - ูุงูู)
- โ Elder (ูุจุงุฑ ุงูุณู - ูุจุณุท)
- โ Guest (ุฒุงุฆุฑ - ุทูุงุฑุฆ)

**ุงูุขู ุงูุชุทุจูู ูุนูู ููุง ูุฌุจ! ๐**
